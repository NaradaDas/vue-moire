"use strict";(self["webpackChunkmoire_build"]=self["webpackChunkmoire_build"]||[]).push([[183],{387:function(e){function r(e){var r=[].slice.call(arguments,1),t=0;return e.replace(/%d/g,(function(){return r[t++]}))}function t(e){return e%10===1&&e%100!==11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2}e.exports=function(e,a,l,o,n){if(!e)return r(a,e);switch(t(e)){case 0:return r(l,e);case 1:return r(o,e);default:return r(n,e)}}},4908:function(e,r,t){function a(){const e=t(387),r=r=>e(r,"Товаров нет","%d товар","%d товара","%d товаров"),a=e=>new Intl.NumberFormat("ru-RU").format(e),l=e=>{const r={red:"Красный",blue:"Синий",green:"Зеленый",yellow:"Желтый",purple:"Фиолетовый",pink:"Розовый",black:"Черный",white:"Белый"};return r[e.toLowerCase().trim()]},o=e=>!!e.gallery&&e.gallery[0].file.url;return{findImage:o,translateColorName:l,editNumberFormat:a,pluralizeProductAmount:r}}t.d(r,{Z:function(){return a}})},4087:function(e,r,t){t.d(r,{Z:function(){return k}});var a=t(3396),l=t(7139);const o={class:"cart__block"},n={class:"cart__orders"},i={class:"cart__total"},d=(0,a.Uk)(" Доставка: "),s=(0,a.Uk)(" Итого: "),u=["disabled"],m={class:"cart__error form__error-block"},c=(0,a._)("h4",null,"Заявка не отправлена!",-1),p=(0,a._)("p",null,"Похоже произошла ошибка. Попробуйте отправить снова или перезагрузите страницу.",-1),_=(0,a.Uk)(" Оформить заказ ");function y(e,r,t,y,v,f){const g=(0,a.up)("BaseSmallLoader");return(0,a.wg)(),(0,a.iD)("div",o,[(0,a._)("ul",n,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.list,(r=>((0,a.wg)(),(0,a.iD)("li",{key:r.id,class:"cart__order"},[(0,a._)("h3",null,(0,l.zw)(r.product.title),1),(0,a._)("b",null,(0,l.zw)(e.editNumberFormat(r.price))+" ₽",1),(0,a._)("span",null,"Размер: "+(0,l.zw)(r.size.title),1),(0,a._)("span",null,"Колличество: "+(0,l.zw)(r.quantity),1),(0,a._)("span",null,"Цвет: "+(0,l.zw)(e.translateColorName(r.color.color.title)),1),(0,a._)("span",null,"Артикул: "+(0,l.zw)(r.id),1)])))),128))]),(0,a._)("div",i,[(0,a._)("p",null,[d,(0,a._)("b",null,(0,l.zw)(e.deliveryPrice.string),1)]),(0,a._)("p",null,[s,(0,a._)("b",null,(0,l.zw)(e.totalQuantity),1),(0,a.Uk)(" "+(0,l.zw)(e.pluralizeProductAmount(e.totalQuantity).split(" ").slice(-1).toString())+" на сумму ",1),(0,a._)("b",null,(0,l.zw)(e.totalPrice)+" ₽",1)])]),"orderInfo"!==e.route.name?((0,a.wg)(),(0,a.iD)("button",{key:0,disabled:e.sending,class:"cart__button button button--primery",type:"submit"},[(0,a.Wm)(g,{class:"button__loader",sending:e.sending,failed:e.error},{default:(0,a.w5)((()=>[((0,a.wg)(),(0,a.j4)(a.lR,{to:"#teleport"},[(0,a._)("div",m,[c,p,(0,a.Uk)(" "+(0,l.zw)(e.errorMessage),1)])]))])),_:1},8,["sending","failed"]),_],8,u)):(0,a.kq)("",!0)])}var v=t(4870),f=t(7084),g=t(4908),b=t(678),w=(0,a.aZ)({props:["error","errorMessage","sending","list","delivery"],components:{BaseSmallLoader:f.Z},setup(e){const r=(0,b.yj)(),{editNumberFormat:t,pluralizeProductAmount:l,translateColorName:o}=(0,g.Z)(),{list:n,delivery:i}=(0,v.BK)(e),d=(0,a.Fl)((()=>n.value.reduce(((e,r)=>r.quantity+e),0))),s=(0,a.Fl)((()=>{if(i.value.deliveryTypeId>0){const e=Number(i.value.deliveryVariety.find((e=>e.id===i.value.deliveryTypeId)).price),r=0===e?"бесплатно":`${e} ₽`;return{string:r,price:e}}return{string:"не выбрано",price:0}})),u=(0,a.Fl)((()=>t(n.value.reduce(((e,r)=>r.quantity*r.price+e),0)+s.value.price)));return{translateColorName:o,route:r,deliveryPrice:s,totalPrice:u,totalQuantity:d,editNumberFormat:t,pluralizeProductAmount:l}}}),h=t(89);const x=(0,h.Z)(w,[["render",y]]);var k=x},4342:function(e,r,t){t.d(r,{Z:function(){return v}});var a=t(3396);const l={class:"breadcrumbs"},o={class:"breadcrumbs__item"},n={class:"breadcrumbs__link",href:"index.html"},i=(0,a.Uk)(" Каталог "),d={class:"breadcrumbs__item"},s={class:"breadcrumbs__link",href:"cart.html"},u=(0,a.Uk)(" Корзина "),m=(0,a._)("li",{class:"breadcrumbs__item"},[(0,a._)("a",{class:"breadcrumbs__link"}," Оформление заказа ")],-1);function c(e,r,t,c,p,_){const y=(0,a.up)("router-link");return(0,a.wg)(),(0,a.iD)("ul",l,[(0,a._)("li",o,[(0,a._)("a",n,[(0,a.Wm)(y,{to:{name:"main"},class:"breadcrumbs__link"},{default:(0,a.w5)((()=>[i])),_:1})])]),(0,a._)("li",d,[(0,a._)("a",s,[(0,a.Wm)(y,{to:{name:"basket"},class:"breadcrumbs__link"},{default:(0,a.w5)((()=>[u])),_:1})])]),m])}var p={},_=t(89);const y=(0,_.Z)(p,[["render",c]]);var v=y},8183:function(e,r,t){t.r(r),t.d(r,{default:function(){return ne}});var a=t(3396),l=t(9242);const o={class:"content container"},n={class:"content__top"},i=(0,a._)("div",{class:"content__row"},[(0,a._)("h1",{class:"content__title"},"Оформление заказа")],-1),d={class:"cart"},s={class:"cart__field"},u={class:"cart__data"},m={class:"cart__options"},c=(0,a._)("h3",{class:"cart__title"},"Доставка",-1),p=(0,a._)("p",null," Не удалось получить варианты доставки. Проверьте интернет-соединие и попробуйте перезагрузить страницу. ",-1),_=(0,a._)("h3",{class:"cart__title"},"Оплата",-1),y={key:2},v=(0,a._)("p",null," Не удалось получить варианты оплаты. Проверьте интернет-соединие и попробуйте перезагрузить страницу. ",-1),f=(0,a._)("div",{id:"teleport"},null,-1);function g(e,r,t,g,b,w){const h=(0,a.up)("OrderBreadcrumbs"),x=(0,a.up)("OrderFormInput"),k=(0,a.up)("OrderFormTextarea"),V=(0,a.up)("BaseSmallLoader"),D=(0,a.up)("OrderRadioList"),T=(0,a.up)("OrderBasketItemsList");return(0,a.wg)(),(0,a.iD)("main",o,[(0,a._)("div",n,[(0,a.Wm)(h),i]),(0,a._)("section",d,[(0,a._)("form",{class:"cart__form form",action:"#",onSubmit:r[7]||(r[7]=(0,l.iM)(((...r)=>e.order&&e.order(...r)),["prevent"]))},[(0,a._)("div",s,[(0,a._)("div",u,[(0,a.Wm)(x,{modelValue:e.formData.name,"onUpdate:modelValue":r[0]||(r[0]=r=>e.formData.name=r),"placeholder-text":"Введите ваше полное имя","label-text":"ФИО","error-text":e.formError.name},null,8,["modelValue","error-text"]),(0,a.Wm)(x,{modelValue:e.formData.address,"onUpdate:modelValue":r[1]||(r[1]=r=>e.formData.address=r),"placeholder-text":"Введите ваш адрес","label-text":"Адрес доставки","error-text":e.formError.address},null,8,["modelValue","error-text"]),(0,a.Wm)(x,{modelValue:e.formData.phone,"onUpdate:modelValue":r[2]||(r[2]=r=>e.formData.phone=r),"placeholder-text":"Введите ваш телефон","label-text":"Телефон","error-text":e.formError.phone},null,8,["modelValue","error-text"]),(0,a.Wm)(x,{modelValue:e.formData.email,"onUpdate:modelValue":r[3]||(r[3]=r=>e.formData.email=r),"placeholder-text":"Введи ваш Email","label-text":"Email","error-text":e.formError.email},null,8,["modelValue","error-text"]),(0,a.Wm)(k,{modelValue:e.formData.comment,"onUpdate:modelValue":r[4]||(r[4]=r=>e.formData.comment=r),"placeholder-text":"Ваши пожелания","label-text":"Комментарий к заказу","error-text":e.formError.comment},null,8,["modelValue","error-text"])]),(0,a._)("div",m,[c,e.isDeliveryLoading||e.isDeliveryLoadingFailed?((0,a.wg)(),(0,a.j4)(V,{key:0,sending:e.isDeliveryLoading,failed:e.isDeliveryLoadingFailed},{default:(0,a.w5)((()=>[p])),_:1},8,["sending","failed"])):((0,a.wg)(),(0,a.j4)(D,{key:1,modelValue:e.deliveryTypeId,"onUpdate:modelValue":r[5]||(r[5]=r=>e.deliveryTypeId=r),variety:e.deliveryVariety,name:"delivery",error:e.formError.deliveryTypeId},null,8,["modelValue","variety","error"])),_,0!==e.paymentVariety.length||e.isPaymentLoading||e.isPaymentLoadingFailed?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",y," Варианты оплаты отобразятся после того, как вы выбирите способ доставки. ")),e.isPaymentLoading||e.isPaymentLoadingFailed?((0,a.wg)(),(0,a.j4)(V,{key:3,sending:e.isPaymentLoading,failed:e.isPaymentLoadingFailed},{default:(0,a.w5)((()=>[v])),_:1},8,["sending","failed"])):(0,a.kq)("",!0),e.paymentVariety.length>0&&!e.isPaymentLoading&&!e.isPaymentLoadingFailed?((0,a.wg)(),(0,a.j4)(D,{key:4,modelValue:e.formData.paymentTypeId,"onUpdate:modelValue":r[6]||(r[6]=r=>e.formData.paymentTypeId=r),variety:e.paymentVariety,name:"payment",error:e.formError.paymentTypeId},null,8,["modelValue","variety","error"])):(0,a.kq)("",!0)])]),(0,a.Wm)(T,{delivery:{deliveryTypeId:e.deliveryTypeId,deliveryVariety:e.deliveryVariety},list:e.store.state.basketData,errorMessage:e.formErrorMessage,error:e.isOrderLoadingFailed,sending:e.isOrderLoading},null,8,["delivery","list","errorMessage","error","sending"]),f],32)])])}const b=["placeholder"];function w(e,r,t,o,n,i){const d=(0,a.up)("OrderFormField");return(0,a.wg)(),(0,a.j4)(d,{"label-text":e.labelText},{default:(0,a.w5)((()=>[(0,a.wy)((0,a._)("textarea",{class:"form__input form__input--area","onUpdate:modelValue":r[0]||(r[0]=r=>e.value=r),placeholder:e.placeholderText},null,8,b),[[l.nr,e.value]])])),_:1},8,["label-text"])}var h=t(7139);const x={class:"form__label"},k={class:"form__value"},V={key:0,class:"form__error"};function D(e,r,t,l,o,n){return(0,a.wg)(),(0,a.iD)("label",x,[(0,a.WI)(e.$slots,"default"),(0,a._)("span",k,(0,h.zw)(e.labelText),1),e.errorText?((0,a.wg)(),(0,a.iD)("span",V,(0,h.zw)(e.errorText),1)):(0,a.kq)("",!0)])}var T=(0,a.aZ)({props:["labelText","errorText"],setup(){return{}}}),F=t(89);const L=(0,F.Z)(T,[["render",D]]);var I=L,Z={props:["placeholderText","modelValue","labelText","errorText"],emits:["update:modelValue"],components:{OrderFormField:I},computed:{value:{get(){return this.modelValue},set(e){return this.$emit("update:modelValue",e),e}}}},P={mixins:[Z]};const z=(0,F.Z)(P,[["render",w]]);var U=z;t(6699);const E=["type","placeholder"];function O(e,r,t,o,n,i){const d=(0,a.up)("OrderFormField");return(0,a.wg)(),(0,a.j4)(d,{"label-text":e.labelText,"error-text":e.errorValue},{default:(0,a.w5)((()=>[(0,a.wy)((0,a._)("input",{onInput:r[0]||(r[0]=(...r)=>e.updateErrorStatus&&e.updateErrorStatus(...r)),class:"form__input","onUpdate:modelValue":r[1]||(r[1]=r=>e.value=r),type:e.placeholderText.includes("телефон")?"tel":"text",placeholder:e.placeholderText},null,40,E),[[l.YZ,e.value]])])),_:1},8,["label-text","error-text"])}var H=t(4870),N=(0,a.aZ)({mixins:[Z],setup(e){const r=(0,H.iH)(),t=t=>{r.value=t.target.value.trim()?null:e.errorText};return(0,a.YP)((()=>e.errorText),(e=>{r.value=e})),{errorValue:r,updateErrorStatus:t}}});const q=(0,F.Z)(N,[["render",O]]);var B=q,W=t(4087);const j={key:0,class:"options__error"},S={class:"cart__options options"},C={class:"options__label"},M=["name","value"],R={class:"options__value"},Y={key:0},A={key:1},Q=(0,a.Uk)(". ");function K(e,r,t,l,o,n){return(0,a.wg)(),(0,a.iD)(a.HY,null,[e.error&&!e.modelValue?((0,a.wg)(),(0,a.iD)("p",j,"Пожалуйста, сделайте выбор.")):(0,a.kq)("",!0),(0,a._)("ul",S,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.variety,((t,l)=>((0,a.wg)(),(0,a.iD)("li",{key:l+t.id,class:"options__item"},[(0,a._)("label",C,[(0,a._)("input",{class:"options__radio sr-only",type:"radio",name:e.name,value:t.id,onInput:r[0]||(r[0]=(...r)=>e.selectType&&e.selectType(...r)),ref_for:!0,ref:"selectElement"},null,40,M),(0,a._)("span",R,[(0,a.Uk)((0,h.zw)(t.title)+" ",1),t.price?((0,a.wg)(),(0,a.iD)("b",Y,(0,h.zw)(0==t.price?"бесплатно":t.price+" ₽"),1)):((0,a.wg)(),(0,a.iD)("b",A,"при получении")),Q])])])))),128))])],64)}var $=(0,a.aZ)({props:["variety","modelValue","name","error"],emits:["update:modelValue"],setup(e,{emit:r}){const t=(0,H.iH)(null),l=e=>{r("update:modelValue",Number(e.target.value))};return(0,a.bv)((()=>{1===e.variety.length&&t.value.forEach((e=>{e.checked=!0,e.disabled=!0,r("update:modelValue",Number(e.value))}))})),{selectElement:t,selectType:l}}});const G=(0,F.Z)($,[["render",K]]);var J=G,X=t(7084),ee=t(4342),re=t(678),te=t(65),ae=t(4078),le=(0,a.aZ)({components:{OrderBreadcrumbs:ee.Z,OrderFormTextarea:U,OrderFormInput:B,OrderBasketItemsList:W.Z,OrderRadioList:J,BaseSmallLoader:X.Z},setup(){const{fetchDeliveryVariety:e,fetchPaymentVariety:r,sendOrder:t}=(0,ae.Z)(),l=(0,H.qj)({}),o=(0,re.tv)(),n=(0,te.oR)(),i=(0,H.iH)(!0),d=(0,H.iH)(!1),s=(0,H.iH)([]);e().then((e=>{s.value=e.data})).catch((()=>{d.value=!0})).then((()=>{i.value=!1}));const u=(0,H.iH)([]),m=(0,H.iH)(!1),c=(0,H.iH)(!1),p=(0,a.Fl)({get(){return l.deliveryTypeId},set(e){return Reflect.deleteProperty(l,"paymentTypeId"),c.value=!1,m.value=!0,r(e).then((e=>{u.value=e.data})).catch((()=>{c.value=!0})).then((()=>{m.value=!1})),Reflect.set(l,"deliveryTypeId",e)}}),_=(0,H.iH)({}),y=(0,H.iH)(""),v=(0,H.iH)(!1),f=(0,H.iH)(!1),g=()=>{f.value=!1,v.value=!0,t(l).then((e=>{o.push({name:"orderInfo",params:{id:e.data.id}}),n.commit("changeBasketItemsQuantity",0),n.commit("updateBasketData",[])})).catch((e=>{_.value=e.response.data.error.request,y.value=e.response.data.error.message,f.value=!0})).then((()=>{v.value=!1}))};return{store:n,isOrderLoadingFailed:f,isOrderLoading:v,order:g,deliveryTypeId:p,paymentVariety:u,isPaymentLoading:m,isPaymentLoadingFailed:c,deliveryVariety:s,isDeliveryLoading:i,isDeliveryLoadingFailed:d,formError:_,formErrorMessage:y,formData:l}}});const oe=(0,F.Z)(le,[["render",g]]);var ne=oe}}]);
//# sourceMappingURL=183.d65d2270.js.map